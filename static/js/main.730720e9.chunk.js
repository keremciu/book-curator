(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{78:function(e,t,n){e.exports=n(96)},96:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),o=n.n(c),i=n(19),l=n(140),u=n(16),s=n.n(u),m=n(12),f=n(27),p="https://ancient-springs-73658.herokuapp.com";function d(e,t){return fetch("".concat(p,"/").concat(e),t).then(function(e){return e.json()}).then(function(e){return[null,e]}).catch(function(e){return[e]})}var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.a.useState(null),a=Object(m.a)(n,2),c=a[0],o=a[1],i=r.a.useState(null),l=Object(m.a)(i,2),u=l[0],p=l[1],b=r.a.useState(!1),E=Object(m.a)(b,2),v=E[0],h=E[1];return r.a.useEffect(function(){p(null),h(!0),function(){var n=Object(f.a)(s.a.mark(function n(){var a,r,c,i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d(e,t);case 2:a=n.sent,r=Object(m.a)(a,2),c=r[0],i=r[1],c&&p(c),o(i),h(!1);case 9:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}()()},[]),{response:c,error:u,loading:v}},E=Object(a.createContext)(null),v={},h=function(){var e=Object(f.a)(s.a.mark(function e(t){var n,a,r,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("me");case 2:n=e.sent,a=Object(m.a)(n,2),r=a[0],c=a[1],r&&t(r),t(c);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g=function(){return Object(a.useContext)(E)},j=function(e){var t=Object(a.useState)(v),n=Object(m.a)(t,2),c=n[0],o=n[1];Object(a.useEffect)(function(){h(o)},[]);var i=function(){return o(v)},l=function(){var e=Object(f.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h(o);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),u=Object(a.useMemo)(function(){return{authData:c,onLogin:l,onLogout:i}},[c]);return r.a.createElement(E.Provider,Object.assign({value:u},e))},O=n(44),y=n(71),x=Object(y.a)({palette:{primary:{main:"#68E181"},secondary:{main:"#19857b"},error:{main:O.a.A400},background:{default:"#fff"},grey:{100:"#F1F6F4"},type:"light"}}),k=n(43),w=n(25),L=n(130),S=n(128),_=n(127),C=n(65),D=n.n(C),z=n(28),F=n(29);function T(){var e=Object(z.a)(["\n  display: flex;\n  align-items: center;\n"]);return T=function(){return e},e}var I=F.a.div(T()),J=function(e){var t=e.error;return t&&r.a.createElement(_.a,{message:r.a.createElement(I,null,r.a.createElement(D.a,null),t.message)})},N=n(129),P=n(142),W=function(e){return e.isLoading&&r.a.createElement(P.a,{p:3},r.a.createElement(S.a,{container:!0,spacing:1,direction:"column",alignItems:"center",justify:"center",style:{height:200}},r.a.createElement(N.a,{size:100})))},A=function(e){var t=e.location,n=g(),c=n.onLogin,o=n.authData,i=Object(a.useState)(null),l=Object(m.a)(i,2),u=l[0],p=l[1],b=Object(a.useState)(!1),E=Object(m.a)(b,2),v=E[0],h=E[1],j=Object(a.useState)(!1),O=Object(m.a)(j,2),y=O[0],x=O[1],k=(t.state||{from:{pathname:"/discovery"}}).from;if(Object(a.useEffect)(function(){o.access_type&&x(!0)},[o]),y)return r.a.createElement(w.a,{to:k});if(v)return r.a.createElement(W,{isLoading:!0});if(u)return r.a.createElement(J,{error:u});var _=function(){var e=Object(f.a)(s.a.mark(function e(){var t,n,a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,d("auth",{method:"POST"});case 3:t=e.sent,n=Object(m.a)(t,2),a=n[0],r=n[1],a&&p(a),"success"===r.status&&(c(),h(!1),x(!0));case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement(S.a,{container:!0,spacing:1,direction:"column",alignItems:"center",justify:"center",style:{height:400}},r.a.createElement(L.a,{variant:"contained",size:"large",color:"primary",onClick:_},"Login"))},B=n(52),G=n(98);function M(){var e=Object(z.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-top: -300px;\n  min-height: 400px;\n  background: linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 1));\n  position: relative;\n  z-index: 1000;\n"]);return M=function(){return e},e}var U=F.a.div(M()),q=function(e){var t=e.match,n=g().authData,a=t.params.id,c=b("books/".concat(a)),o=c.response,i=c.error;return c.loading?r.a.createElement(W,{isLoading:!0}):i?r.a.createElement(J,{error:i}):o?r.a.createElement(B.a,null,r.a.createElement(P.a,{p:3},r.a.createElement(G.a,{variant:"h2",component:"h2"},r.a.createElement(P.a,{mb:4},o.title)),r.a.createElement(G.a,{component:"p"},o.content),"free"===n.access_type&&r.a.createElement(U,null,r.a.createElement(L.a,{variant:"contained",size:"large",color:"primary"},"Subscribe to read")))):null},H=n(143),K=n(132),Q=n(133),R=n(134),V=n(136),X=n(135),Y=n(144),Z=n(70),$=n(131);function ee(e){var t=e.children,n=e.activeTab,a=e.index,c=Object(k.a)(e,["children","activeTab","index"]);return r.a.createElement(G.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"vertical-tabpanel-".concat(a),"aria-labelledby":"vertical-tab-".concat(a)},c),r.a.createElement(P.a,{p:2},t))}var te=function(){var e=Object(Z.a)(),t=Object($.a)(e.breakpoints.down("xs")),n=Object(a.useState)(0),c=Object(m.a)(n,2),o=c[0],l=c[1],u=b("categories"),s=u.response,f=u.error,p=u.loading,d=b("books").response;if(p)return r.a.createElement(W,{isLoading:!0});if(f)return r.a.createElement(J,{error:f});if(!s||!d)return null;var E=s.categories,v=function(e,t){return e.reduce(function(e,n){var a=n.book_ids.map(function(e){return t.find(function(t){return t.id===e})});return e.push({id:n.id,books:a}),e},[])}(E,d.books);return r.a.createElement(S.a,{container:!0,spacing:2},r.a.createElement(S.a,{item:!0,md:3,xs:12},r.a.createElement(B.a,null,r.a.createElement(H.a,{orientation:t?"horizontal":"vertical",variant:"scrollable",value:o,onChange:function(e,t){return l(t)},"aria-label":"Categories"},E.map(function(e){return r.a.createElement(K.a,{key:e.id,label:e.title,id:e.id})})))),r.a.createElement(S.a,{item:!0,md:9},r.a.createElement(B.a,null,v.map(function(e,t){return r.a.createElement(ee,{key:e.id,activeTab:o,index:t},r.a.createElement(S.a,{container:!0,spacing:2},e.books.map(function(e,n){return r.a.createElement(S.a,{key:e.id,item:!0,md:3,xs:6},r.a.createElement(i.b,{to:"/book/".concat(e.id)},r.a.createElement(Y.a,{in:t===o,timeout:440*(n+1)},r.a.createElement(Q.a,null,r.a.createElement(R.a,null,r.a.createElement(X.a,{image:e.image_url,title:e.title,style:{height:140}}),r.a.createElement(V.a,null,r.a.createElement(G.a,{component:"h6"},e.title)))))))})))}))))},ne=function(e){var t=e.component,n=Object(k.a)(e,["component"]),a=g().authData;return r.a.createElement(w.b,Object.assign({},n,{render:function(e){return a.user_id?r.a.createElement(t,e):r.a.createElement(w.a,{to:{pathname:"/",state:{from:e.location}}})}}))},ae=function(){return r.a.createElement(w.d,null,r.a.createElement(w.b,{exact:!0,path:"/",component:A}),r.a.createElement(ne,{path:"/discovery",component:te}),r.a.createElement(ne,{path:"/book/:id",component:q}),r.a.createElement(w.b,{path:"*",component:function(){return"NOT FOUND"}}))},re=n(145),ce=n(137),oe=n(139),ie=n(138),le=n(146);function ue(){var e=Object(z.a)(["\n  flex: 1 0 100%;\n  padding-top: 74px;\n"]);return ue=function(){return e},e}function se(){var e=Object(z.a)(["\n  display: flex;\n"]);return se=function(){return e},e}var me=F.a.div(se()),fe=F.a.div(ue()),pe=function(e){var t=e.children,n=g(),c=n.authData,o=n.onLogout;return r.a.createElement(me,null,r.a.createElement(re.a,null),r.a.createElement(ce.a,{color:"default",elevation:0},r.a.createElement(ie.a,{maxWidth:"md"},r.a.createElement(oe.a,null,r.a.createElement(G.a,{variant:"h6",style:{flexGrow:1}},"Curator"," ",c.user_id&&r.a.createElement(le.a,{label:c.access_type})),c.user_id?r.a.createElement(a.Fragment,null,r.a.createElement(L.a,{component:i.b,to:"/discovery"},"Discovery"),r.a.createElement(L.a,{onClick:o},"Logout")):r.a.createElement(L.a,{component:i.b,to:"/"},"Login")))),r.a.createElement(fe,null,r.a.createElement(ie.a,{maxWidth:"md"},t)))};var de=function(){return r.a.createElement(i.a,{basename:"/book-curator"},r.a.createElement(j,null,r.a.createElement(l.a,{theme:x},r.a.createElement(pe,null,r.a.createElement(ae,null)))))};o.a.render(r.a.createElement(de,null),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.730720e9.chunk.js.map